/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
    id 'io.qameta.allure' version '2.8.1'
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2/')
    }
    maven {
        url =uri('https://plugins.gradle.org/m2/')
    }
}

dependencies {
    implementation 'com.browserstack:browserstack-local-java:1.0.3'
    implementation 'com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.12.2'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.12.2'
    implementation 'org.apache.commons:commons-lang3:3.12.0'
    implementation 'junit:junit:4.12'
    implementation 'org.seleniumhq.selenium:selenium-java:3.141.59'
    implementation 'ch.qos.logback:logback-classic:1.2.3'
    implementation 'org.seleniumhq.selenium:selenium-api:3.141.59'
    implementation 'io.qameta.allure:allure-junit4:2.13.8'
    implementation 'org.apache.maven.plugins:maven-surefire-plugin:2.21.0'
    testImplementation 'com.browserstack:webdriver-framework-junit4:0.0.1'
}

group = 'com.browserstack'
version = '1.0-SNAPSHOT'
description = 'browserstack-examples-junit4'
java.sourceCompatibility = JavaVersion.VERSION_1_8

allure.version '2.21.0'
allure.configuration 'testImplementation'
allure.autoconfigure true
allure.reportDir  file('allure-report')
allure.resultsDir file('allure-results')


task on_prem(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }
    if (System.getProperty("test-name") != null) {
        include '**/'+System.getProperty("test-name")+'.class'
    }
    if (System.getProperty("test-name") == null) {
        include '**/ImageNotLoading.class'
    }
    systemProperty 'profileId', 'on-prem'
    systemProperty 'capabilities.config', 'capabilities-localdriver.yml'
    systemProperty 'parallel.type', 'all'
}


task on_prem_suite(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    include 'com/browserstack/suites/**/*.class'

    systemProperty 'profileId', 'on-prem-suite'
    systemProperty 'capabilities.config', 'capabilities-localdriver.yml'
    systemProperty 'parallel.type', 'classes'
}


task bstack_single(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    if (System.getProperty("test-name") != null) {
        include '**/'+System.getProperty("test-name")+'.class'
    }
    if (System.getProperty("test-name") == null) {
        include '**/ImageNotLoading.class'
    }

    systemProperty 'profileId', 'bstack-single'
    systemProperty 'capabilities.config', 'capabilities-bstack-parallel.yml'
    systemProperty 'parallel.type', 'all'
}


task bstack_parallel(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    include 'com/browserstack/suites/**/*.class'

    systemProperty 'profileId', 'bstack-parallel'
    systemProperty 'capabilities.config', 'capabilities-bstack-parallel.yml'
    systemProperty 'parallel.type', 'all'
}

task bstack_parallel_browsers(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    include 'com/browserstack/suites/**/*.class'

    systemProperty 'profileId', 'bstack-parallel-browsers'
    systemProperty 'capabilities.config', 'capabilities-bstack-parallel-browsers.yml'
    systemProperty 'parallel.type', 'classes'
}


task bstack_local(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    if (System.getProperty("test-name") != null) {
        include '**/'+System.getProperty("test-name")+'.class'
    }
    if (System.getProperty("test-name") == null) {
        include '**/ImageNotLoading.class'
    }

    systemProperty 'profileId', 'bstack-local'
    systemProperty 'capabilities.config', 'capabilities-bstack-local.yml'
    systemProperty 'parallel.type', 'classes'
}


task bstack_local_parallel(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    include 'com/browserstack/suites/**/*.class'

    systemProperty 'profileId', 'bstack-local-parallel'
    systemProperty 'capabilities.config', 'capabilities-bstack-local-parallel.yml'
    systemProperty 'parallel', 'all'
}


task bstack_local_parallel_browsers(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    include 'com/browserstack/suites/**/*.class'

    systemProperty 'profileId', 'bstack-local-parallel-browsers'
    systemProperty 'capabilities.config', 'capabilities-bstack-local-parallel-browsers.yml'
    systemProperty 'parallel', 'classes'
}


task docker(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    if (System.getProperty("test-name") != null) {
        include '**/'+System.getProperty("test-name")+'.class'
    }
    if (System.getProperty("test-name") == null) {
        include '**/ImageNotLoading.class'
    }

    systemProperty 'profileId', 'docker'
    systemProperty 'capabilities.config', 'capabilities-dockerdriver.yml'
    systemProperty 'parallel', 'all'

}


task docker_parallel(type: Test){
    useJUnit()
    testLogging {
        showStandardStreams = true
    }

    include 'com/browserstack/suites/**/*.class'

    systemProperty 'profileId', 'docker-parallel'
    systemProperty 'capabilities.config', 'capabilities-dockerdriver.yml'
    systemProperty 'parallel', 'all'
}


publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}
